<div *ngIf="stepList.length"
     class="ngx-carousel {{animation ? carouselAnimationClass : null}}"
     [class.overflow-hidden]="hideOverFlow"
     [ngStyle]="{
                height: height,
                width: width
              }"
     [ngxCarouselKeyEvents]="useKeyboard"
     (right)="next()"
     (left)="previous()">
  <div *ngFor="let step of stepList; let stepIndex = index;"
       ngxCarouselSwipe
       (right)="next()"
       (left)="previous()"
       class="ngx-carousel-step ngx-carousel-step-{{stepIndex}}
        {{(animation && applyAnimationToSteps && step.animation) ? carouselAnimationClass : null}}"
       [ngStyle]="{
                    height: height,
                    'background-image': step.bgImage ? step.bgImage : '',
                    'background-color': step.bgColor,
                    'background-size': step.backgroundSize || stepBackgroundSize
                  }"
       [ngClass]="{
                    'display-none': stepIndex !== selectedIndex,
                    'display-block': stepIndex === selectedIndex,
                    'image-background-style': !!step.bgImage
                  }"
                  #stepEleRef>
    <div class="ngx-carousel-step-content"
         [ngStyle]="{
            'height.px': stepEleRef.offsetHeight - 40
         }">
      <ng-container *ngTemplateOutlet="step.stepContentDirectiveTemplateRef?.templateRef"></ng-container>
    </div>
    <div *ngIf="!step.hideOverlay"
         class="ngx-carousel-step-overlay"
         [style.background-color]="step.overlayColor"
         [style.opacity]="step.overlayOpacity">
    </div>
  </div>
  <a class="ngx-carousel-previous-button previous-button {{previousButtonClass}}"
     *ngIf="loop || selectedIndex !== 0"
     [ngClass]="{
                  'previous-button-outside': outsideButton,
                  'allow-button-animation': allowButtonAnimation
                }"
     (click)="previous()">
    <ng-container *ngIf="!previousButtonDirectiveTemplateRef">
      <span class="icon-span" [ngStyle]="{
          'background-color': selectedStep?.buttonBg || buttonBg || '#FFFFFF',
          color: getButtonTextColor(selectedStep?.buttonBg || buttonBg || '#FFFFFF')
        }">
        <i class="{{previousButtonIconClass}}"></i>
      </span>
    </ng-container>
    <ng-container *ngIf="previousButtonDirectiveTemplateRef?.templateRef">
      <ng-container *ngTemplateOutlet="previousButtonDirectiveTemplateRef?.templateRef"></ng-container>
    </ng-container>
  </a>
  <a class="ngx-carousel-previous-button next-button {{nextButtonClass}}"
     *ngIf="loop || selectedIndex !== stepList.length - 1"
     [ngClass]="{
                  'next-button-outside': outsideButton,
                  'allow-button-animation': allowButtonAnimation
                }"
     (click)="next()">
    <ng-container *ngIf="!nextButtonDirectiveTemplateRef">
      <span class="icon-span" [ngStyle]="{
          'background-color': selectedStep?.buttonBg || buttonBg || '#FFFFFF',
          color: getButtonTextColor(selectedStep?.buttonBg || buttonBg || '#FFFFFF')
        }">
        <i class="{{nextButtonIconClass}}"></i>
      </span>
    </ng-container>
    <ng-container *ngIf="nextButtonDirectiveTemplateRef?.templateRef">
      <ng-container *ngTemplateOutlet="nextButtonDirectiveTemplateRef?.templateRef"></ng-container>
    </ng-container>
  </a>
  <div *ngIf="showDots" class="ngx-carousel-dot-container">
    <span *ngFor="let step of stepList; let stepIndex = index;"
          [style.background-color]="dotsBg"
          [class.active]="stepIndex === selectedIndex"
          class="ngx-carousel-dot {{dotsClass}}" (click)="slideTo(stepIndex)">
    </span>
  </div>
</div>
